
import axios from 'axios';

export class VulnerabilityScanningModule {
  constructor(config) {
    this.config = config;
    this.findings = [];
    this.axiosInstance = axios.create({ timeout: 10000, validateStatus: ()=>true });
  }

  async checkKnownVulns() {
    console.log('  [03] Testing Known Vulnerabilities (Fingerprinting)...');
    try {
        const res = await this.axiosInstance.get(this.config.target);
        const headers = res.headers;
        const findings = [];

        // Check X-Powered-By
        if(headers['x-powered-by']) {
            findings.push({
                severity: 'LOW',
                category: 'Information Disclosure',
                title: 'Technology Leak (X-Powered-By)',
                description: `Server reveals technology: ${headers['x-powered-by']}`,
                remediation: 'Remove X-Powered-By header.',
                cvss: 2.0
            });
        }
        
        // Check Server
        if(headers['server']) {
             findings.push({
                severity: 'LOW',
                category: 'Information Disclosure',
                title: 'Server Version Leak',
                description: `Server header revealed: ${headers['server']}`,
                remediation: 'Obscure Server header info.',
                cvss: 2.0
            });
        }

        return { findings };
    } catch(e) {
        return { findings: [] };
    }
  }
}
